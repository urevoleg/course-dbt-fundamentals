# Deeper Jinja

![deeper.jpeg](img%2Fdeeper.jpeg)

–í —ç—Ç–æ–π —á–∞—Å—Ç–∏ —Ç–µ–±—è –∂–¥—É—Ç –º–∞–∫—Ä–æ—Å—ã –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è.

## Macros

Macros (–º–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è) - –∫—É—Å–æ—á–∫–∏ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ–¥–Ω–æ—Ç–∏–ø–Ω—ã—Ö –ø–æ–≤—Ç–æ—Ä—è–µ–º—ã—Ö –≤—ã–∑–æ–≤–æ–≤, —Ç–∞–∫ —Å–∫–∞–∑–∞—Ç—å –±—É–¥–µ—à—å —Å–ª–µ–¥–æ–≤–∞—Ç—å 
–ø—Ä–∏–Ω—Ü–∏–ø—É [DRY](https://ru.wikipedia.org/wiki/Don‚Äôt_repeat_yourself) (—Ç—ã —Å–º–æ–∂–µ—à—å –≥–æ—Ä–¥–æ —Å–∫–∞–∑–∞—Ç—å –æ–± —ç—Ç–æ–º –Ω–∞ —Å–æ–±–µ—Å–µ =))

![dry.png](img%2Fdry.png)


–ë–∞–∑–æ–≤—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å:

```sql
{% macro macro_name(*args, **kwargs)%}

{% endmacro %}
```

–ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ `macro` +  –Ω–∞–±–æ—Ä –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, –ø—Ä—è–º–æ –∫–∞–∫ –≤ Python - –≤—Å—ë –∫–∞–∫ —Ç—ã –ª—é–±–∏—à—å.

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –¥—Ä—É–≥–∏—Ö —à–∞–±–ª–æ–Ω–∞ —Ç–∞–∫ –∂–µ –∫–∞–∫ –∏ –ª—é–±–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä `{{macro_name()}}`

–ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞—à–∏ –Ω–∞–≤—ã–∫–∏: –Ω–∞–ø–∏—à–µ–º –º–∞–∫—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–æ–¥–∏—Ç —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É, –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∑–∞–¥–∞–¥–∏–º –∏–º—è –ø–æ–ª—è —Å –¥–∞—Ç–æ–π

```sql
{% macro current_datetime(column_name)%}
SELECT now() as {{column_name}};
{% endmacro %}

{{ current_datetime('dt') }}
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:

```sql
SELECT now() as dt;
```

–ö–∞–∫ —Å–æ–∑–¥–∞–≤–∞—Ç—å –º–∞–∫—Ä–æ—Å—ã –∏ –≤—ã–∑—ã–≤–∞—Ç—å –∏—Ö —Ç—ã —É–º–µ–µ—à—å, —Ç–µ–ø–µ—Ä—å –Ω—É–∂–Ω–æ —É—Å–∏–ª–∏—Ç—å —Å–≤–æ—é –º–æ—â—å: –ø–∏—Å–∞—Ç—å –∫–∞–∂–¥—ã–π —Ä–∞–∑ –º–∞–∫—Ä–æ—Å —Ä–∞–¥–∏ –µ–≥–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—è - –ø–ª–æ—Ö–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –∏ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—Ç DRY.
–î–∞–ª–µ–µ –ø–æ–∑–Ω–∞–∫–æ–º–∏–º—Å—è —Å —Ç–µ–º –∫–∞–∫ —Ä–∞—Å—à–∏—Ä—è—Ç—å –º–æ–¥–µ–ª–∏ –º–∞–∫—Ä–æ—Å–∞–º–∏ –∏ —Ä–µ—à–∏–º –∑–∞–¥–∞—á—É:

**–ó–∞–¥–∞—á–∞:**

–ß—Ç–æ–±—ã –Ω–µ –ø–∏—Å–∞—Ç—å –∫–∞–∂–¥—ã–π —Ä–∞–∑ –æ–±—Ä–∞–±–æ—Ç–∫—É –Ω–∞—à–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ (–ø–æ–º–Ω–∏—à—å, —Ç–∞–º –º–Ω–æ–≥–æ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏, —Ç–∏–ø—ã, —Å—Ç—Ä–æ–∫–∏ –∏ –ø—Ä–æ—á–µ–µ) –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:
- —Å–æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å —Å –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–æ–π (–±–∞–∑–æ–≤–æ –≤—ã–¥–µ–ª–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é —Å—Ç—Ä–∞–Ω—É, –æ—Å–Ω–æ–≤–Ω–æ–π –∂–∞–Ω—Ä, –ø—Ä–∏–≤–µ—Å—Ç–∏ –≥–æ–¥ –∫ —Ü–µ–ª–æ–º—É —á–∏—Å–ª—É, –≤—ã–¥–µ–ª–∏—Ç—å —Ä–µ–π—Ç–∏–Ω–≥ IMDb –∏ –∏ –ø—Ä–∏–≤–µ—Å—Ç–∏ –µ–≥–æ –∫ –¥–µ—Å—è—Ç–∏—á–Ω–æ–º—É —á–∏—Å–ª—É)
- —Å–¥–µ–ª–∞—Ç—å –∏–∑ –∑–∞–ø—Ä–æ—Å–∞ –º–∞–∫—Ä–æ—Å-–∏—Å—Ç–æ—á–Ω–∏–∫ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –º–æ–¥–µ–ª–µ–π

## Extends

Extends –∏–ª–∏ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤ - –æ—á–µ–Ω—å —É–¥–æ–±–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –≥–∏–±–∫–æ—Å—Ç–∏ –≤–∞—à–∏—Ö —à–∞–±–ª–æ–Ω–æ–≤. –ù–∞–ø—Ä–∏–º–µ—Ä, —Ç–µ–±–µ –ª–µ–Ω—å –ø–∏—Å–∞—Ç—å –∫–∞–∂–¥—ã–π —Ä–∞–∑ –∫–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã 
–∏–ª–∏ –≤—å—é—Ö–∏ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞, —Ç–æ–≥–¥–∞ —Ç–µ–±–µ –Ω—É–∂–Ω—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è. 

Extends - –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç–∏–ø —à–∞–±–ª–æ–Ω–æ–≤, –≤–Ω—É—Ç—Ä–∏ –∫–æ—Ç–æ—Ä—ã—Ö —É–∫–∞–∑–∞–Ω–æ, —á—Ç–æ –∑–∞–º–µ–Ω–∏—Ç—å –∏–ª–∏ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å –º–æ–∂–Ω–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –±–ª–æ–∫, –ø—Ä–∏–º–µ—Ä —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞:

```sql
SELECT *,
       now() as load_datetime
FROM (
         {% block query %}{% endblock %}
     )
```

–ó–¥–µ—Å—å —à–∞–±–ª–æ–Ω –¥–æ–±–∞–≤–ª—è–µ—Ç –¥–∞—Ç—É –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö (–∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—É—â—É—é –Ω–∞ –º–æ–º–µ–Ω—Ç –∑–∞–ø—Ä–æ—Å–∞) + –µ—Å—Ç—å –Ω–æ–≤—ã–π –±–ª–æ–∫ `{% block query %}{% endblock %}` - –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π –±–ª–æ–∫, –∫–æ—Ç–æ—Ä—ã–π
–∫–∞–∫ —Ä–∞–∑ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞—Å—à–∏—Ä—è—Ç—Å—è. –í –ª—é–±–æ–π –¥—Ä—É–≥–æ–π –º–æ–¥–µ–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–ø–∏—Å–∞—Ç—å —ç—Ç–æ—Ç –±–ª–æ–∫ (—Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∏–º–µ–Ω–∏) - —Ç–æ –µ—Å—Ç—å —É–∫–∞–∑–∞—Ç—å —Ç–æ—Ç SQL –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–º –Ω—É–∂–µ–Ω.
–ü—Ä–µ–¥—ã–¥—É—â–∏–π –∫–æ–¥ —Å–æ—Ö—Ä–∞–Ω–∏ –≤ [add_load_datetime.sql](templates%2Fadd_load_datetime.sql)
–ü—Ä–æ–±—É–µ—à—å:

```sql
{% extends 'add_load_datetime.sql' %}
{% block query -%}
SELECT film_name
       country ,
       genre ,
       director ,
       budget ,
       box_office_usa ,
       rating_imbd 
FROM stg.kinopoisk 
{%- endblock %}
```

–°—Ç—Ä–æ–∫–∞ `{% extends 'add_load_datetime.sql' %}` - –∫–∞–∫ —Ä–∞–∑ –∏ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ, –∏ –∑–¥–µ—Å—å –∂–µ –º—ã –æ–ø–∏—Å—ã–≤–∞–µ–º –Ω–∞—à –±–ª–æ–∫ `query`, —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞:

```sql
SELECT *,
       now() as load_datetime
FROM (
         SELECT film_name
       country ,
       genre ,
       director ,
       budget ,
       box_office_usa ,
       rating_imbd
FROM stg.kinopoisk
     ) sq
```

## –°–æ–µ–¥–∏–Ω—è—è –Ω–µ—Å–æ–µ–¥–∏–Ω–∏–º–æ–µ

–¢–µ–±–µ –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç –ø—É—Ç—å –≤–æ–∏–Ω–∞: —Å–æ–µ–¥–∏–Ω–∏—Ç—å –≤—Å–µ –∫—É—Å–æ—á–∫–∞ –ø–∞–∑–ª–∞ –≤–º–µ—Å—Ç–µ:
- —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- –º–∞–∫—Ä–æ—Å—ã
- –∏ —Ç–µ–±–µ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ - –∑–¥–µ—Å—å –≤–æ–æ–±—â–µ –≤—Å—ë –∫–∞–∫ –≤ Python

–ß—Ç–æ–±—ã –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–π –º–∞–∫—Ä–æ—Å –∏—Å–ø–æ–ª—å–∑—É–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å `{% import 'add_load_datetime.sql' as m %}`, –¥–ª—è –≤—ã–∑–æ–≤–∞ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –º–∞–∫—Ä–æ—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–π —Ç–æ—á–µ—á–Ω—É—é –Ω–æ—Ç–∞—Ü–∏—é
`{{ m.current_datetime() }}`

–í–∞–∂–Ω–æ: –ø–µ—Ä–µ–º–µ—â–∞–µ–º –º–∞–∫—Ä–æ—Å –≤ –ø–∞–ø–∫—É –º–∞–∫—Ä–æ—Å–æ–≤ `macros/add_load_datetime.sql`, —Ç–µ–ø–µ—Ä—å, —á—Ç–æ–±—ã –≤—Å–µ —à–∞–±–ª–æ–Ω—ã –∑–∞–≥—Ä—É–∂–∞–ª–∏—Å—å –ø—Ä–æ–ø–∏—à–∏ —Å–ø–∏—Å–æ–∫ –ø–∞–ø–æ–∫:

```python
stmt = get_rendered_template(["../templates", "../macros", "../models"],
                                 "extends-example.sql")

print(stmt)
```

–ü–æ–ø—Ä–æ–±—É–µ—à—å —Å–∞–º –Ω–∞–ø–∏—Å–∞—Ç—å –∫–æ–¥.... (—Ç–∞–∫–∂–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–µ–º–Ω–æ–≥–æ –ø–æ–ø—Ä–∞–≤–∏—Ç—å –º–∞–∫—Ä–æ—Å, —Ç–∫ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞–º –Ω—É–∂–Ω–æ)

–ú–æ—ë —Ä–µ—à–µ–Ω–∏–µ –Ω–∞–π–¥–µ—à—å –∑–¥–µ—Å—å [model-1.sql](models%2Fmodel-1.sql), —á—É—Ä –Ω–µ –ø–æ–¥–≥–ª—è–¥—ã–≤–∞—Ç—å üòé

## –¢–≤–æ–π –ø–µ—Ä–≤—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö

–ü–æ–º–Ω–∏—à—å –Ω–∞—à—É –∑–∞–¥–∞—á—É:
–ß—Ç–æ–±—ã –Ω–µ –ø–∏—Å–∞—Ç—å –∫–∞–∂–¥—ã–π —Ä–∞–∑ –æ–±—Ä–∞–±–æ—Ç–∫—É –Ω–∞—à–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ (–ø–æ–º–Ω–∏—à—å, —Ç–∞–º –º–Ω–æ–≥–æ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏, —Ç–∏–ø—ã, —Å—Ç—Ä–æ–∫–∏ –∏ –ø—Ä–æ—á–µ–µ) –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:
- —Å–æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å —Å –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–æ–π (–±–∞–∑–æ–≤–æ –≤—ã–¥–µ–ª–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é —Å—Ç—Ä–∞–Ω—É, –æ—Å–Ω–æ–≤–Ω–æ–π –∂–∞–Ω—Ä, –ø—Ä–∏–≤–µ—Å—Ç–∏ –≥–æ–¥ –∫ —Ü–µ–ª–æ–º—É —á–∏—Å–ª—É, –≤—ã–¥–µ–ª–∏—Ç—å —Ä–µ–π—Ç–∏–Ω–≥ IMDb –∏ –∏ –ø—Ä–∏–≤–µ—Å—Ç–∏ –µ–≥–æ –∫ –¥–µ—Å—è—Ç–∏—á–Ω–æ–º—É —á–∏—Å–ª—É)
- –¥–æ–±–∞–≤–∏—Ç—å –¥–∞—Ç—É –∑–∞–≥—Ä—É–∑–∫–∏
- –¥–æ–±–∞–≤–∏—Ç—å –∏–º—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞

–¢–µ–ø–µ—Ä—å –¥–ª—è —ç—Ç–æ–≥–æ —É —Ç–µ–±—è –≤—Å—ë –µ—Å—Ç—å. –û–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–∞–∫–∏–º

```sql
{% extends 'add_load_datetime_source.sql' %}
{% block qdt -%}
SELECT film_name,
       lower(split_part(country, '_', 1)) as country,
       lower(split_part(genre, '_', 1)) as genre ,
       lower(split_part(director, '_', 1)) as director ,
       regexp_replace(substring(budget from '[\d+\s+]+'), '\s+', '', 'g')::int8 as budget,
       regexp_replace(substring(box_office_usa from '[\d+\s+]+'), '\s+', '', 'g')::int8 as box_office_usa,
       regexp_replace(substring(rating_imbd from '\d.\d+'), '\s+', '', 'g')::float imdb
FROM stg.kinopoisk
WHERE film_name IS NOT NULL
{%- endblock qdt %}
```

–§–∞–π–ª [add_load_datetime_source.sql](macros%2Fadd_load_datetime_source.sql) –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è, –∑–∞–ø—Ä–æ—Å –ø–∏—à–µ–º —Ä—É—á–∫–∞–º–∏.


–ú–æ–¥–µ–ª—å –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –≥–æ—Ç–æ–≤–∞ (–ø–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ –µ—ë –∑–∞—á–∞—Ç–æ—á–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ). –ß—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –µ—ë –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é (—Ç–∞–±–ª–∏—Ü–∞ –∏–ª–∏ –≤—å—é—Ö–∞),
–¥–ª—è —ç—Ç–æ –ø–∏—à–µ—à—å –µ—â–µ –Ω–µ–±–æ–ª—å—à–æ–π –º–∞–∫—Ä–æ—Å:

```sql
{%- macro materialization(type, schema, name) -%}
DROP {% if type=='table' %} TABLE {% else %} VIEW {% endif -%} IF EXISTS {{schema}}.{{name}};
CREATE {% if type=='table' %} TABLE {% else %} VIEW {% endif -%} {{schema}}.{{name}} AS
{%- endmacro -%}
```

–ú–∞–∫—Ä–æ—Å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∫–æ–¥ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã –∏–ª–∏ –≤—å—é—Ö–∏ - –¥–µ–π—Å—Ç–≤—É–µ–º –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É: _–∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º –æ–±—å–µ–∫—Ç_

–î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –æ–Ω –≤ —Ç–µ–∫—Å—Ç –º–æ–¥–µ–ª–∏ –ø—Ä–æ—Å—Ç—ã–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º `include` - –ø—Ä–æ—Å—Ç–æ –≤–µ—Å—å —Ç–µ–∫—Å—Ç –ø—Ä–∏–±–∞–≤–∏—Ç—å—Å—è –∫ –∏–º–µ—é—â–µ–º—É—Å—è. –ò—Ç–æ–≥–æ –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–∞—à–µ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞:

```sql
{% from 'config.sql' import materialization %}
{{materialization(type='table', schema='dds', name='raw_kp')}}
{% extends 'add_load_datetime_source.sql' %}
{% block qdt -%}
SELECT production_year,
       film_name,
       lower(split_part(country, '_', 1)) as country,
       lower(split_part(genre, '_', 1)) as genre ,
       lower(split_part(director, '_', 1)) as director ,
       regexp_replace(substring(budget from '[\d+\s+]+'), '\s+', '', 'g')::int8 as budget,
       regexp_replace(substring(box_office_usa from '[\d+\s+]+'), '\s+', '', 'g')::int8 as box_office_usa,
       regexp_replace(substring(rating_imbd from '\d.\d+'), '\s+', '', 'g')::float imdb
FROM stg.kinopoisk
WHERE film_name IS NOT NULL
AND production_year != ''
{%- endblock qdt %}
```

–ì–µ–Ω–µ—Ä–∏–º –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥, –∞ –¥–∞–≤–∞–π —á—Ç–æ–±—ã –Ω–µ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å, —Å–æ–∑–¥–∞–¥–∏–º –ø–∞–ø–∫—É `compiled` –∏ –±—É–¥–µ–º —Ç—É–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –æ—Ç—Ä–µ–Ω–¥–µ—Ä–µ–Ω–Ω—ã–π —à–∞–±–ª–æ–Ω, –≥–æ—Ç–æ–≤—ã–π –¥–ª—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è, –ø–æ–≥–Ω–∞–ª–∏:

```python
def save_compiled_model(file:str, folder:str='compiled'):
    with open(os.path.join(folder, file), 'w') as f:
        f.write(stmt)
```

–ó–∞–ø—É—Å–∫–∞–µ–º `main.py` –∏ –ø–æ–ª—É—á–∞–µ–º –≥–æ—Ç–æ–≤—ã–π –∫–æ–¥ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –∏—Å–ø–æ–ª–Ω—è–µ–º –≤ DBeaver –∏ —á–µ–∫–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

![dds-raw.png](img%2Fdds-raw.png)

üëâ [Deep and deeper, go to chapter 2-3](https://github.com/urevoleg/course-dbt-fundamentals/blob/main/course/chapter-2/README-2-3.md)
